webpackJsonp([8],{"003u":function(e,r){},"2t7q":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o={name:"SignUp",data:function(){var e=this;return{form:{name:"",pwd1:"",pwd2:"",email:""},errors:[],creating:!1,codeDisabled:!1,submitDisabled:!1,submitText:"创建账户",rules:{name:{validator:function(e,r,t){r||t(new Error("请输入用户名")),t()},trigger:"blur"},pwd1:{validator:function(r,t,o){t&&e.form.pwd2&&e.$refs.form.validateField("pwd2"),!t||t.length<8?o(new Error("密码太短")):o()},trigger:"blur"},pwd2:{validator:function(r,t,o){t?t!==e.form.pwd1?o(new Error("密码不匹配")):o():o(new Error("确认密码不可为空"))},trigger:"blur"},email:{validator:function(e,r,t){r||t(new Error("邮箱不可为空"));/^\w+((-\w+)|(\.\w+))*@[A-Za-z\d]+((\.|-)[A-Za-z\d]+)*\.[A-Za-z\d]+$/.test(r)||t(new Error("这不是一个邮箱")),t()},trigger:"blur"}}}},methods:{querySearchEmail:function(e,r){var t=[];[{value:"@qq.com"},{value:"@126.com"},{value:"@163.com"},{value:"@sina.com"},{value:"@21cn.com"},{value:"@sohu.com"},{value:"@yahoo.com.cn"},{value:"@tom.com"},{value:"@etang.com"},{value:"@eyou.com"},{value:"@56.com"},{value:"@x.cn"},{value:"@chinaren.comsogou.com"},{value:"@citiz.com"}].foreach(function(r){t.push({value:e.split("@")[0]+r.value})}),r(e?t.filter(this.createFilter(e)):t)},createFilter:function(e){return function(r){return 0===r.value.toLowerCase().indexOf(e.toLowerCase())}},submitForm:function(e){var r=this;this.$refs[e].validate(function(e){if(!e)return!1;r.creating=!0,r.submitText="正在创建",r.$axios.post("/api/v1/users/",{name:r.form.name,email:r.form.email,password:r.form.pwd2}).then(function(e){r.creating=!1;var t=e.data;Object.prototype.hasOwnProperty.call(t,"uuid")&&(r.submitText="创建成功，正在跳转登录...",setTimeout(function(){r.$router.push("/login"+(r.$route.query.redirect||""))},3e3))}).catch(function(e){var t=e.response.data,o=[];if("string"==typeof t)o.push(t);else for(var a in t)o=o.concat(t[a]);r.errors=o,r.creating=!1,console.log(r.errors),r.submitText="创建失败",r.submitDisabled=!0,setTimeout(function(){r.submitText="重新创建",r.submitDisabled=!1},3e3)})})},resetForm:function(e){this.$refs[e].resetFields()}}},a={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("el-form",{ref:"form",staticClass:"signup",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[t("el-form-item",[t("h3",[e._v("注册用户")])]),e._v(" "),e.errors.length?t("div",{staticClass:"errors"},e._l(e.errors,function(r,o){return t("span",{key:o},[e._v(e._s(r))])}),0):e._e(),e._v(" "),t("el-form-item",{attrs:{label:"用户名",prop:"name"}},[t("el-input",{attrs:{"prefix-icon":"el-icon-user"},model:{value:e.form.name,callback:function(r){e.$set(e.form,"name",r)},expression:"form.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"密码",prop:"pwd1"}},[t("el-input",{attrs:{"prefix-icon":"el-icon-lock","show-password":""},model:{value:e.form.pwd1,callback:function(r){e.$set(e.form,"pwd1",r)},expression:"form.pwd1"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"确认密码",prop:"pwd2"}},[t("el-input",{attrs:{"prefix-icon":"el-icon-lock","show-password":""},model:{value:e.form.pwd2,callback:function(r){e.$set(e.form,"pwd2",r)},expression:"form.pwd2"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"电子邮件",prop:"email"}},[t("el-autocomplete",{staticClass:"email",attrs:{"fetch-suggestions":e.querySearchEmail,"trigger-on-focus":!1,"prefix-icon":"el-icon-message"},model:{value:e.form.email,callback:function(r){e.$set(e.form,"email",r)},expression:"form.email"}})],1),e._v(" "),t("el-form-item",[t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.creating,expression:"creating"}],attrs:{disabled:e.submitDisabled,type:"primary"},on:{click:function(r){return e.submitForm("form")}}},[e._v("\n      "+e._s(e.submitText)+"\n    ")]),e._v(" "),t("el-button",{on:{click:function(r){return e.resetForm("form")}}},[e._v("重置")])],1)],1)},staticRenderFns:[]};var i=t("VU/8")(o,a,!1,function(e){t("003u")},"data-v-1449258d",null);r.default=i.exports}});
//# sourceMappingURL=8.0afccc12ccbb0a2d47ad.js.map