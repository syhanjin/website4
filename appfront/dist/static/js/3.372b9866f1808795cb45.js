webpackJsonp([3],{ATV9:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={name:"SettingsViewPC",data:function(){return{avatarCropperDialog:!1,avatarImg:"",avatarPreview:{},avatarPreviewStyle:{},signature:{edit:!1,text:""}}},methods:{setSignatureFinished:function(){var t=this;this.signature.edit=!1,this.$axios.post("/api/v1/users/set_signature/",{new_signature:this.signature.text}).then(function(e){t.$store.commit("setSignature",t.signature.text)}).catch(function(e){t.$message({dangerouslyUseHTMLString:!0,message:e.response.data,type:"error"})})},setSignature:function(){this.signature.text=this.$store.state.me.signature,this.signature.edit=!0},avatarUpload:function(t){this.avatarCropperDialog=!0,this.avatarImg=URL.createObjectURL(t.file)},avatarSubmit:function(){var t=this;this.avatarLoading=!0,this.$refs.avatarCropper.getCropBlob(function(e){var a=new FormData,i=new window.File([e],"avatar.jpg",{type:"image/jpeg"});a.append("new_avatar",i),t.$axios.post("/api/v1/users/set_avatar/",a).then(function(e){t.$nextTick(function(){t.$store.commit("setAvatar",t.BASEURL+e.data.avatar)})}).catch(function(e){t.$message({dangerouslyUseHTMLString:!0,message:e.response.data,type:"error"})})}),this.avatarCropperDialog=!1},avatarRealTime:function(t){var e=t;this.avatarPreviewStyle={width:e.w+"px",height:e.h+"px",overflow:"hidden",margin:"0",zoom:100/e.w},this.avatarPreview=t}}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"settings"},[a("div",{staticClass:"header"},[a("el-upload",{staticClass:"avatar",attrs:{action:"","show-file-list":!1,"http-request":t.avatarUpload,accept:"image/jpeg",name:"new_avatar"}},[a("el-avatar",{key:t.$store.state.me.avatar,attrs:{src:t.$store.state.me.avatar,size:100}}),t._v(" "),a("i",{staticClass:"el-icon-edit-outline avatar-uploader-icon"})],1),t._v(" "),a("el-dialog",{attrs:{width:"750px",visible:t.avatarCropperDialog,closeOnClickModal:!1,center:""},on:{"update:visible":function(e){t.avatarCropperDialog=e}}},[a("div",{staticClass:"avatar-cropper-box"},[a("VueCropper",{ref:"avatarCropper",staticClass:"avatar-cropper",attrs:{img:t.avatarImg,outputSize:1,outputType:"jpeg",autoCrop:!0,fixed:!0,centerBox:!0,mode:"128px"},on:{realTime:t.avatarRealTime}}),t._v(" "),a("div",{staticClass:"avatar-cropper-right"},[a("div",{staticClass:"avatar-preview",style:t.avatarPreviewStyle},[a("div",{style:t.avatarPreview.div},[a("img",{style:t.avatarPreview.img,attrs:{src:t.avatarImg}})])]),t._v(" "),a("el-button",{staticClass:"avatar-cropper-submit",attrs:{plain:"",type:"primary"},on:{click:t.avatarSubmit}},[t._v("修改头像")])],1)],1)]),t._v(" "),a("div",{staticClass:"header-right"},[a("h2",{staticClass:"name--big"},[t._v(t._s(t.$store.state.me.name))]),t._v(" "),a("div",{staticClass:"signature"},[t.signature.edit?t._e():a("span",[t._v(t._s(t.$store.state.me.signature||"未设置个性签名"))]),t._v(" "),t.signature.edit?a("el-input",{attrs:{type:"text",placeholder:"设置个性签名",maxlength:"15",clearable:!0,"show-word-limit":""},on:{change:t.setSignatureFinished,blur:t.setSignatureFinished},model:{value:t.signature.text,callback:function(e){t.$set(t.signature,"text",e)},expression:"signature.text"}}):t._e(),t._v(" "),t.signature.edit?t._e():a("el-button",{attrs:{icon:"el-icon-edit",type:"text"},on:{click:t.setSignature}})],1)])],1),t._v(" "),a("el-descriptions",{attrs:{title:"基本信息",column:2,labelStyle:{width:"11%"},contentStyle:{width:"33%"},border:""}},[a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-user"}),t._v("\n        用户名\n      ")]),t._v("\n      "+t._s(t.$store.state.me.name)+"\n    ")],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-key"}),t._v("\n        用户编号\n      ")]),t._v("\n      "+t._s(t.$store.state.me.uuid)+"\n    ")],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-ali-email"}),t._v("\n        邮箱\n      ")]),t._v(" "),t.$store.state.me.email?a("span",[t._v("\n       "+t._s(t.$store.state.me.email)+"\n      ")]):t._e(),t._v(" "),t.$store.state.me.email?t._e():a("span",[a("el-link",{attrs:{type:"primary",icon:"el-icon-edit-outline"}},[t._v("绑定邮箱")])],1)],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-ali-mobile"}),t._v("\n        手机\n      ")]),t._v(" "),t.$store.state.me.phone?a("span",[t._v("\n       "+t._s(t.$store.state.me.phone)+"\n      ")]):t._e(),t._v(" "),t.$store.state.me.phone?t._e():a("span",[a("el-link",{attrs:{type:"primary",icon:"el-icon-edit-outline",disabled:""}},[t._v("绑定手机")])],1)],2),t._v(" "),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-alarm-clock"}),t._v("\n        创建时间\n      ")]),t._v(" "),a("span",[t._v("\n       "+t._s(t._f("dateFormat")(t.$store.state.me.created))+"\n      ")])],2)],1)],1)},staticRenderFns:[]};var r=a("VU/8")(i,s,!1,function(t){a("kn9k")},"data-v-a281e332",null);e.default=r.exports},kn9k:function(t,e){}});
//# sourceMappingURL=3.372b9866f1808795cb45.js.map