webpackJsonp([7],{"1qyc":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={name:"LogIn",data:function(){return{form:{name:"",password:""},errors:[],rules:{name:{validator:function(t,e,r){e?r():r(new Error("用户名不可为空"))},trigger:"blur"},password:{validator:function(t,e,r){e?r():r(new Error("密码不可为空"))},trigger:"blur"}},submitting:!1,submitDisabled:!1,submitText:"登录"}},beforeCreate:function(){this.$store.state.isAuthenticated&&this.$router.push(this.$route.query.redirect||"/")},methods:{submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;e.submitting=!0,e.submitText="登录中...",e.$axios.defaults.headers.common.Authorization="",localStorage.removeItem("token"),e.$axios.post("/api/v1/token/login/",e.form).then(function(t){e.submitting=!1;var r=t.data.auth_token;e.$store.commit("setToken",r),e.$axios.defaults.headers.common.Authorization="Token "+r,localStorage.setItem("token",r),e.submitText="登录成功",e.$router.push(e.$route.query.redirect||"/")}).catch(function(t){e.submitting=!1;var r=t.response.data;if(Object.prototype.hasOwnProperty.call(r,"non_field_errors"))e.errors=["用户名或密码错误"],e.submitText="再次尝试";else{var s=[];if("string"==typeof r)s.push(r);else for(var o in r)s=s.concat(r[o]);e.errors=s,e.submitText="登录失败",e.submitDisabled=!0,setTimeout(function(){e.submitText="再次尝试",e.submitDisabled=!1},3e3)}})})}},computed:{qqloginUrl:function(){return"https://graph.qq.com/oauth2.0/authorize?response_type=code&client_id=101978697&redirect_uri=https%3A%2F%2Fsakuyark.com%2Faccount%2Flogin%2Fqq&state=login"}}},o={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"login"},[r("h3",{staticClass:"title"},[t._v("登录")]),t._v(" "),r("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules}},[r("el-form-item",{attrs:{prop:"name"}},[r("el-input",{attrs:{placeholder:"用户名","prefix-icon":"el-icon-user"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),r("el-form-item",{attrs:{prop:"password"}},[r("el-input",{attrs:{placeholder:"密码","prefix-icon":"el-icon-lock","show-password":""},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),t.errors.length?r("div",{staticClass:"errors"},t._l(t.errors,function(e,s){return r("span",{key:s},[t._v(t._s(e))])}),0):t._e(),t._v(" "),r("el-form-item",[r("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.submitting,expression:"submitting"}],staticClass:"loginBtn",attrs:{disabled:t.submitDisabled,plain:""},on:{click:function(e){return t.submitForm("form")}}},[t._v("\n        "+t._s(t.submitText)+"\n      ")])],1)],1),t._v(" "),r("div",{staticClass:"other"},[r("div",{staticClass:"login-ways"},[r("span",[t._v("其他")]),t._v(" "),r("div",{staticClass:"login-qq"},[r("a",{attrs:{id:"qqloginBtn",href:t.qqloginUrl}})])]),t._v(" "),r("div",{staticClass:"retrieve"},[r("span",[t._v("忘记密码？")]),t._v(" "),r("a",{attrs:{href:t.$route.path+"/retrieve"}},[t._v("找回密码")])]),t._v(" "),r("div",{staticClass:"clear"})])],1)},staticRenderFns:[]};var i=r("VU/8")(s,o,!1,function(t){r("4zWC")},"data-v-1b426b27",null);e.default=i.exports},"4zWC":function(t,e){}});
//# sourceMappingURL=7.079f9031e1a299d06cd7.js.map